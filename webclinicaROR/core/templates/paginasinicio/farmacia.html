{% extends "paginasinicio/base.html" %}
{% load static %}
{% load currency_filters %}

{% block content %}
<link rel="stylesheet" href="{% static '/css/Farmacia.css' %}">

<nav class="navbar navbar-expand-lg navbar-secondary bg-white shadow-sm mt-5">
    <div class="container">
        <form class="d-flex mx-auto w-50" role="search">
            <input class="form-control me-2 rounded-pill" type="search" placeholder="Buscar productos..." aria-label="Search">
            <button class="btn btn-success rounded-pill px-4" type="submit">Buscar</button>
        </form>
        <ul class="navbar-nav ms-auto">
            <li class="nav-item">
                <a class="nav-link position-relative" data-bs-toggle="offcanvas" href="#carritoPanel">
                    <img src="{% static '/assets/icon/carrito.png' %}" alt="Carrito">
                    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
                </a>
            </li>
        </ul>
    </div>
</nav>

<div class="offcanvas offcanvas-end" tabindex="-1" id="carritoPanel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">ðŸ›’ Tu Carrito</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column">
        <ul id="lista-carrito" class="list-group flex-grow-1"></ul>
        <hr>
        <p class="fw-bold">Total: <span id="total-carrito">$0</span></p>
        <button class="btn btn-success w-100 mt-2">Comprar</button>
    </div>
</div>

<section class="productos-section py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-5 titulos3">Nuestros Productos</h2>
        <div class="row g-4">

            {% for producto in productos %}
            <div class="col-md-4 producto" data-nombre="{{ producto.nombre }}">
                <div class="producto-card shadow-sm rounded-4">
                    <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="producto-img rounded-top-4">
                    <div class="producto-info p-3">
                        <h4 class="producto-nombre">{{ producto.nombre }}</h4>
                        <p class="producto-desc">{{ producto.descripcion|truncatewords:15 }}</p>
                        <p class="producto-precio">{{ producto.precio|clp_format }}</p>
                        <button class="btn btn-success btn-add">Agregar al carrito</button>
                    </div>
                </div>
            </div>
            {% empty %}
            <p class="text-center">No hay productos disponibles en este momento.</p>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static '/js/farmacia.js' %}"></script>
{% endblock %}